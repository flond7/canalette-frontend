<div class="bg-dark-l rounded p-3 mb-4">

  <!-- UTENTE -->
  <div *ngIf="view === 'user'" class="">
    <form [formGroup]="userForm" class="d-flex flex-column w-100">
      <div class="row w-100">
        <div class="col-4">
          <label>Nome * </label><small *ngIf="userForm.controls['first_name']?.errors && userForm.controls['first_name'].dirty" class="text-danger ml-1">{{messages.required}}</small>
          <input formControlName="first_name" [(ngModel)]="data.first_name" name="first_name" type="text" class="form-control" required/>
        </div>
        <div class="col-4">
          <label>Cognome * </label><small *ngIf="userForm.controls['last_name']?.errors && userForm.controls['last_name'].dirty" class="text-danger ml-1">{{messages.required}}</small>
          <input formControlName="last_name" [(ngModel)]="data.last_name" name="last_name" type="text" class="form-control" required/>
        </div>
        <div class="col-4">
          <label>Codice Fiscale * </label><small *ngIf="userForm.controls['cf']?.errors && userForm.controls['cf'].dirty" class="text-danger ml-1">{{messages.required}}</small>
          <input formControlName="cf" [(ngModel)]="data.cf" name="cf" type="text" class="form-control" required/>
        </div>
      </div>

      <div class="row w-100 mt-2">
        <div class="col-5">
          <label>Email</label>
          <input formControlName="email" [(ngModel)]="data.email" name="" type="text" class="form-control" />
        </div>
        <div class="col-3">
          <label for="tel">Telefono</label>
          <input formControlName="tel" [(ngModel)]="data.tel" name="" type="text" class="form-control" />
        </div>
        <div class="col-3">
          <label>Stato</label>
          <div class="select-wrapper">
            <select formControlName="category" [(ngModel)]="data.category">
              <option value="citizen">Privato</option>
              <option value="business">Azienda</option>
            </select>
          </div>

        </div>
      </div>
    </form>
  </div>

  <!-- CANALETTA -->
  <div *ngIf="view === 'drain'" class="">
    <div class="row">
      <form [formGroup]="drainForm" class="d-flex w-100">
        <div class="col-4">
          <label for="num">Numero</label><span *ngIf="">Inserisci il numero</span>
          <input formControlName="num" [(ngModel)]="data.num" name="num" type="text" class="form-control" />
        </div>
        <div class="col-4">
          <label>Indirizzo canaletta</label>
          <input formControlName="street" [(ngModel)]="data.street" name="street" type="text" class="form-control" />
        </div>
        <div class="col-2">
          <label>Fogl.</label>
          <input formControlName="fogl" [(ngModel)]="data.fogl" name="fogl" type="text" class="form-control" />
        </div>
        <div class="col-2">
          <label>Map.</label>
          <input formControlName="map" [(ngModel)]="data.map" name="map" type="text" class="form-control" />
        </div>
      </form>
    </div>
  </div>

  <!-- TASSE ANNUALI -->
  <div *ngIf="view === 'year'" class="row mt-3">
    <form [formGroup]="yearForm" class="d-flex w-100">
      <div class="col-4">
        <label>Anno</label>
        <input formControlName="year" [(ngModel)]="data.year" name="year" type="number" class="form-control" />
      </div>
      <div class="col-4">
        <label>Imposta privato</label>
        <input formControlName="taxCitizen" [(ngModel)]="data.taxCitizen" (focusout)="convertToDouble(data.taxCitizen, 'taxCitizen')" name="taxCitizen"
          type="number" class="form-control" />
      </div>
      <div class="col-4">
        <label>Imposta azienda</label>
        <input formControlName="taxBusiness" [(ngModel)]="data.taxBusiness" (focusout)="convertToDouble(data.taxBusiness, 'taxBusiness')" name="taxBusiness"
          type="text" class="form-control" />
      </div>
    </form>
  </div>

  <!-- SAVE -->
  <div *ngIf="status=='new'" class="row justify-content-end mt-3">
    <div *ngIf="view=='user'" class="col-3">
      <button class="btn btn-secondary w-100 my-2" (click)="saveUser()" [disabled]="!userForm.valid">Salva
        tasse</button>
    </div>
    <div *ngIf="view=='drain'" class="col-3">
      <button class="btn btn-secondary w-100 my-2" (click)="save()" [disabled]="!drainForm.valid">Salva
        canaletta</button>
    </div>

    <div *ngIf="view=='year'" class="col-3">
      <button class="btn btn-secondary w-100 my-2" (click)="saveYear()" [disabled]="!yearForm.valid">Salva
        tasse</button>
    </div>
  </div>

</div>

<!-- WARNING -->
<div class="row">
  <div class="col">
    <app-warning class="w-100" [showAlert]="this.showAlert" [warningMessage]="this.message" [type]="this.type">
    </app-warning>
  </div>
</div>

<app-anag-user></app-anag-user>